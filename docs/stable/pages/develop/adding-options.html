<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Debugging COSMIC" href="debugging-vscode.html" /><link rel="prev" title="Creating new settings" href="new-settings.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.08.06 -->
        <title>Adding options to existing settings - COSMIC v3.6.0</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=e15ddae3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/solid.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/brands.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/cosmic-docs.css?v=4e6f89a8" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-grid.min.css?v=ebdf2caa" />
    
    


<style>
  body {
    --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --color-brand-primary: #3f95e1;
  --color-brand-content: #3f95e1;
  --color-brand-visited: #3f95e1;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #f08c33;
  --color-brand-content: #f08c33;
  --color-brand-visited: #f08c33;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #f08c33;
  --color-brand-content: #f08c33;
  --color-brand-visited: #f08c33;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand"><span class='hide-me'>COSMIC </span>v3.6.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="https://cosmic-popsynth.github.io/images/cosmic-popsynth_1200.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text"><span class='hide-me'>COSMIC </span>v3.6.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference_material.html">Configuration and output</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Configuration and output</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../inifile.html">Configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../output_info.html">Understanding COSMIC outputs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples.html">Evolving binaries</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Evolving binaries</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../evolve/single.html">Evolving a single binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evolve/multiple.html">Evolving multiple binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evolve/grid.html">Evolving a fixed grid of binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evolve/evolve_sample.html">Evolving a Monte-Carlo sampled population</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evolve/resolution.html">Dynamic time resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evolve/restart.html">Restarting a binary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../runpop.html">Sampling initial populations</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Sampling initial populations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../sample/independent.html">Independent distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sample/multidim.html">Multidimensional distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sample/cluster.html">ClusterMonteCarlo Sampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fixedpop.html">Generate a population the <cite>COSMIC</cite> way</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing COSMIC</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../developers.html">For Developers</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of For Developers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="how-it-works.html">Codebase overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="new-settings.html">Creating new settings</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Adding options to existing settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging-vscode.html">Debugging COSMIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="settings-json-file.html"><code class="docutils literal notranslate"><span class="pre">cosmic-settings.json</span></code> file explained</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/COSMIC-popsynth/COSMIC/blob/develop/docs/pages/develop/adding-options.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/COSMIC-popsynth/COSMIC/edit/develop/docs/pages/develop/adding-options.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="adding-options-to-existing-settings">
<h1>Adding options to existing settings<a class="headerlink" href="#adding-options-to-existing-settings" title="Link to this heading">¶</a></h1>
<p>This page will guide you through the process of adding new options to existing settings in COSMIC.
This is a little simpler than adding a new setting, you can read more about how to do that <a class="reference external" href="new-settings.html">here</a>.</p>
<p>As an example, we will add a new option for how to handle black hole supernova kicks.</p>
<section id="summary-checklist">
<h2>Summary checklist<a class="headerlink" href="#summary-checklist" title="Link to this heading">¶</a></h2>
<p>Been here before and just making sure you’re not missing anything? Here’s a quick checklist:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src/cosmic/src</span></code>: Add the new option to the relevant COSMIC code file and <strong>test your changes</strong>!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docs/cosmic-settings.json</span></code>: Add the new option to the JSON file</p></li>
</ul>
</section>
<section id="code-changes">
<h2>Code changes<a class="headerlink" href="#code-changes" title="Link to this heading">¶</a></h2>
<p>First, we need to actually change the underlying COSMIC code to allow for this new option. Given that we’re
going to change black hole kicks work, this will happen in the <code class="docutils literal notranslate"><span class="pre">src/cosmic/src/kick.f</span></code> file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The exact file that you need to change may differ depending on what option you change!
For example, if you were changing how mass transfer works, you’d need to change the <code class="docutils literal notranslate"><span class="pre">src/cosmic/src/evolv2.f</span></code> file instead.</p>
<p>If you’re not
familiar with the codebase, you may want to search the <code class="docutils literal notranslate"><span class="pre">src/cosmic/src</span></code> directory for any mention of the
setting to which you’re adding an option.</p>
</div>
<p>In our case, we want to add to the <code class="docutils literal notranslate"><span class="pre">bhflag</span></code> setting, which is used to determine how black hole supernova kicks are handled.
At the time of writing, this setting is used as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">src/cosmic/src/kick.f</span></code></p>
<div class="highlight-fortranfixed notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nl">    .</span><span class="gs">.</span><span class="p">..</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="nl">     </span> <span class="k">if</span><span class="p">(</span><span class="n">kw</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="mf">4.</span><span class="nb">and</span><span class="p">.</span><span class="n">bhflag</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="linenos"> 4</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span>
<span class="linenos"> 5</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span>
<span class="linenos"> 6</span><span class="nl">     </span> <span class="n">elseif</span><span class="p">(</span><span class="n">kw</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="mf">4.</span><span class="nb">and</span><span class="p">.</span><span class="n">bhflag</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<span class="linenos"> 7</span><span class="nl">     </span> <span class="w">    </span><span class="n">fallback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">fallback</span><span class="p">,</span><span class="mf">1.d0</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">((</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">fallback</span><span class="p">)</span><span class="o">*</span><span class="n">vk</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vk</span><span class="o">*</span><span class="n">vk</span>
<span class="linenos">10</span><span class="nl">     </span> <span class="n">elseif</span><span class="p">(</span><span class="n">kw</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="mf">4.</span><span class="nb">and</span><span class="p">.</span><span class="n">bhflag</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<span class="linenos">11</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vk</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mxns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">m1n</span>
<span class="linenos">12</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vk</span><span class="o">*</span><span class="n">vk</span>
<span class="linenos">13</span><span class="nl">     </span> <span class="k">endif</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="nl">    .</span><span class="gs">.</span><span class="p">..</span>
</pre></div>
</div>
<p>There are currently 4 options implemented for the <code class="docutils literal notranslate"><span class="pre">bhflag</span></code> setting, which are 0, 1, 2, and 3
(Note that the code snippet above only shows 0, 1, and 2 because 3 means that the black hole kick is not changed
from the value for neutron stars). You can see conditions for each which check that <code class="docutils literal notranslate"><span class="pre">kw</span></code> is 14 (which ensures
this is a black hole) and then set the kick velocity according to the <code class="docutils literal notranslate"><span class="pre">bhflag</span></code> value.</p>
<p>Let’s add a 5th option, which sets the black hole kick to <strong>double</strong> the value for neutron stars (this is
of course a rather contrived example, but it serves to illustrate the process).</p>
<p><code class="docutils literal notranslate"><span class="pre">src/cosmic/src/kick.f</span></code></p>
<div class="highlight-fortranfixed notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nl">    .</span><span class="gs">.</span><span class="p">..</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="nl">     </span> <span class="k">if</span><span class="p">(</span><span class="n">kw</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="mf">4.</span><span class="nb">and</span><span class="p">.</span><span class="n">bhflag</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<span class="linenos"> 4</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span>
<span class="linenos"> 5</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.d0</span>
<span class="linenos"> 6</span><span class="nl">     </span> <span class="n">elseif</span><span class="p">(</span><span class="n">kw</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="mf">4.</span><span class="nb">and</span><span class="p">.</span><span class="n">bhflag</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span><span class="k">then</span>
<span class="linenos"> 7</span><span class="nl">     </span> <span class="w">    </span><span class="n">fallback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MIN</span><span class="p">(</span><span class="n">fallback</span><span class="p">,</span><span class="mf">1.d0</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">((</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">fallback</span><span class="p">)</span><span class="o">*</span><span class="n">vk</span><span class="p">,</span><span class="mf">0.d0</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vk</span><span class="o">*</span><span class="n">vk</span>
<span class="linenos">10</span><span class="nl">     </span> <span class="n">elseif</span><span class="p">(</span><span class="n">kw</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="mf">4.</span><span class="nb">and</span><span class="p">.</span><span class="n">bhflag</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="k">then</span>
<span class="linenos">11</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vk</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mxns</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">m1n</span>
<span class="linenos">12</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vk</span><span class="o">*</span><span class="n">vk</span>
<span class="hll"><span class="linenos">13</span><span class="nl">     </span> <span class="n">elseif</span><span class="p">(</span><span class="n">kw</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="mf">4.</span><span class="nb">and</span><span class="p">.</span><span class="n">bhflag</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span><span class="k">then</span>
</span><span class="hll"><span class="linenos">14</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vk</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.d0</span>
</span><span class="hll"><span class="linenos">15</span><span class="nl">     </span> <span class="w">    </span><span class="n">vk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vk</span><span class="o">*</span><span class="n">vk</span>
</span><span class="linenos">16</span><span class="nl">     </span> <span class="k">endif</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="nl">    .</span><span class="gs">.</span><span class="p">..</span>
</pre></div>
</div>
</section>
<section id="documentation-changes">
<h2>Documentation changes<a class="headerlink" href="#documentation-changes" title="Link to this heading">¶</a></h2>
<p>Now we need to actual let COSMIC users that this new option exists. We’ll need to update this in
a single place and this will propagate into the INI files and docs pages too (hurrah for structured data!)</p>
<p>Head over to the <code class="docutils literal notranslate"><span class="pre">docs/cosmic-settings.json</span></code> file and let’s add a new option to <code class="docutils literal notranslate"><span class="pre">bhflag</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">docs/pages/inifile.rst</span></code></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w">    </span><span class="err">....</span>
<span class="linenos"> 2</span><span class="w">        </span><span class="p">{</span>
<span class="linenos"> 3</span><span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bhflag&quot;</span><span class="p">,</span>
<span class="linenos"> 4</span><span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Sets the model for how SN kicks are applied to BHs, where bhflag != 0 allows for velocity kick at BH formation&quot;</span><span class="p">,</span>
<span class="linenos"> 5</span><span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dropdown&quot;</span><span class="p">,</span>
<span class="linenos"> 6</span><span class="w">            </span><span class="nt">&quot;options-preface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="linenos"> 7</span><span class="w">            </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="linenos"> 8</span><span class="w">                </span><span class="p">{</span>
<span class="linenos"> 9</span><span class="w">                    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="linenos">10</span><span class="w">                    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;No BH kick&quot;</span>
<span class="linenos">11</span><span class="w">                </span><span class="p">},</span>
<span class="linenos">12</span><span class="w">                </span><span class="p">{</span>
<span class="linenos">13</span><span class="w">                    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="linenos">14</span><span class="w">                    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fallback-modulated kicks following &lt;a class=&#39;reference external&#39; href=&#39;https://ui.adsabs.harvard.edu/abs/2012ApJ...749...91F/abstract&#39;&gt;Fryer+2012&lt;/a&gt;&quot;</span><span class="p">,</span>
<span class="linenos">15</span><span class="w">                    </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="linenos">16</span><span class="w">                </span><span class="p">},</span>
<span class="linenos">17</span><span class="w">                </span><span class="p">{</span>
<span class="linenos">18</span><span class="w">                    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="linenos">19</span><span class="w">                    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;kicks decreased by ratio of BH mass to NS mass (1.44 Msun); conserves linear momentum&quot;</span>
<span class="linenos">20</span><span class="w">                </span><span class="p">},</span>
<span class="linenos">21</span><span class="w">                </span><span class="p">{</span>
<span class="linenos">22</span><span class="w">                    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="linenos">23</span><span class="w">                    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;BH natal kicks are not decreased compared to NS kicks and are drawn from the same Maxwellian distribution with dispersion = &lt;code&gt;sigma&lt;/code&gt; set above&quot;</span>
<span class="linenos">24</span><span class="w">                </span><span class="p">},</span>
<span class="hll"><span class="linenos">25</span><span class="w">                </span><span class="p">{</span>
</span><span class="hll"><span class="linenos">26</span><span class="w">                    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
</span><span class="hll"><span class="linenos">27</span><span class="w">                    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;A silly option that sets BH kicks to double the value for NSs&quot;</span>
</span><span class="hll"><span class="linenos">28</span><span class="w">                </span><span class="p">}</span>
</span><span class="linenos">29</span><span class="w">            </span><span class="p">]</span>
<span class="linenos">30</span><span class="w">        </span><span class="p">},</span>
<span class="linenos">31</span><span class="w">    </span><span class="err">....</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you’re confused about how to format your addition to the JSON file, check out <a class="reference internal" href="settings-json-file.html#json"><span class="std std-ref">cosmic-settings.json file explained</span></a> to better understand this file.</p>
</div>
<p>This addition to the JSON file will then be used to update the Params.ini file and the config docs page with the new option.</p>
<p>And that’s it! You’ve successfully added a new option to an existing setting in COSMIC, nice job!</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="debugging-vscode.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Debugging COSMIC</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="new-settings.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Creating new settings</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, Katie Breivik
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link fa-brands fa-solid fa-github fa-2x" href="https://github.com/COSMIC-PopSynth/COSMIC" aria-label="GitHub"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Adding options to existing settings</a><ul>
<li><a class="reference internal" href="#summary-checklist">Summary checklist</a></li>
<li><a class="reference internal" href="#code-changes">Code changes</a></li>
<li><a class="reference internal" href="#documentation-changes">Documentation changes</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5349f462"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=5eb46824"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/custom.js?v=fedf5a9c"></script>
    </body>
</html>