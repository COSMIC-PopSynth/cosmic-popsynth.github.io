<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using COSMIC to evolve binaries &mdash; cosmic 3.4.7 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/cosmic-docs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generate a binary population by hand" href="../runpop/index.html" />
    <link rel="prev" title="Describing the output of COSMIC/BSE: Columns names/Values/Units" href="../output_info/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> cosmic
          </a>
              <div class="version">
                3.4.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inifile/index.html">Configuration files for COSMIC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output_info/index.html">Describing the output of COSMIC/BSE: Columns names/Values/Units</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using COSMIC to evolve binaries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#single-binary">single binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiple-binaries">multiple binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#grid-of-binaries">grid of binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dynamically-set-time-resolution-for-bcm-array">dynamically set time resolution for bcm array</a></li>
<li class="toctree-l2"><a class="reference internal" href="#restarting-a-binary">restarting a binary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../runpop/index.html">Generate a binary population by hand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fixedpop/index.html">Generate a population the <cite>COSMIC</cite> way</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cosmic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Using COSMIC to evolve binaries</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-cosmic-to-evolve-binaries">
<span id="examples"></span><h1>Using COSMIC to evolve binaries<a class="headerlink" href="#using-cosmic-to-evolve-binaries" title="Permalink to this heading"></a></h1>
<p>COSMIC can evolve binaries for several different use cases. Below
you’ll find examples to run a single binary system, multiple binary
systems or a grid of binaries.</p>
<section id="single-binary">
<h2>single binary<a class="headerlink" href="#single-binary" title="Permalink to this heading"></a></h2>
<p>Below is the process to initialize and evolve a binary that
could have formed a GW150914-like binary. First, import the modules in COSMIC
that initialize and evolve the binary.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">cosmic.sample.initialbinarytable</span> <span class="kn">import</span> <span class="n">InitialBinaryTable</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">cosmic.evolve</span> <span class="kn">import</span> <span class="n">Evolve</span>
</pre></div>
</div>
<p>To initialize a single binary, populate the InitialBinaries method in the
InitialBinaryTable class. Each initialized binary requires the following parameters:</p>
<ul class="simple">
<li><p>m1 : ZAMS mass of the primary star in <img class="math" src="../_images/math/ff0e573cc61eb74d35f469b1124988be4aeaaffb.png" alt="M_{\odot}"/></p></li>
<li><p>m2 : ZAMS mass of the secondary star in <img class="math" src="../_images/math/ff0e573cc61eb74d35f469b1124988be4aeaaffb.png" alt="M_{\odot}"/></p></li>
<li><p>porb : initial orbital period in days</p></li>
<li><p>ecc : initial eccentricity</p></li>
<li><p>tphysf : total evolution time of the binary in Myr</p></li>
<li><p>kstar1 : initial primary stellar type, following the BSE convention</p></li>
<li><p>kstar2 : initial secondary stellar type, following the BSE convention</p></li>
<li><p>metallicity : metallicity of the population (e.g. <img class="math" src="../_images/math/579b9dec8da28f91cf822a2b2e1a181bd6e482e8.png" alt="Z_{\odot}=0.014"/>)</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">single_binary</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">InitialBinaries</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="mf">85.543645</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="mf">84.99784</span><span class="p">,</span> <span class="n">porb</span><span class="o">=</span><span class="mf">446.795757</span><span class="p">,</span> <span class="n">ecc</span><span class="o">=</span><span class="mf">0.448872</span><span class="p">,</span> <span class="n">tphysf</span><span class="o">=</span><span class="mf">13700.0</span><span class="p">,</span> <span class="n">kstar1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kstar2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metallicity</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="nb">print</span><span class="p">(</span><span class="n">single_binary</span><span class="p">)</span>
<span class="go">   kstar_1  kstar_2     mass_1    mass_2        porb       ecc  metallicity   tphysf    mass0_1   mass0_2  rad_1  rad_2  lum_1  ...  B_2  bacc_1  bacc_2  tacc_1  tacc_2  epoch_1  epoch_2  tms_1  tms_2  bhspin_1  bhspin_2  tphys  binfrac</span>
<span class="go">0      1.0      1.0  85.543645  84.99784  446.795757  0.448872        0.002  13700.0  85.543645  84.99784    0.0    0.0    0.0  ...  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>

<span class="go">[1 rows x 38 columns]</span>
</pre></div>
</div>
<p>The flags for the various binary evolution prescriptions used in BSE also need to be set.
Each flag is saved in the BSEDict dictionary. Note that the BSEDict
only needs to be specified the first time a binary is evolved with COSMIC or
if you need to change the binary evolution prescriptions.</p>
<p>If you are unfamiliar with these prescriptions, it is highly
advised to either run the defaults from the COSMIC install which are consistent
with <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019arXiv191100903B/abstract">Breivik+2020</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">BSEDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;bhflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;neta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;windflag&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;wdflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;pts1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;pts3&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;pts2&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;epsnov&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;hewind&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;ck&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;bwind&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lambdaf&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;mxns&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;tflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc2&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;grflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;remnantflag&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ceflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;eddfac&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ifflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bconst&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">265.0</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;pisn&#39;</span><span class="p">:</span> <span class="mf">45.0</span><span class="p">,</span> <span class="s1">&#39;natal_kick_array&#39;</span> <span class="p">:</span> <span class="p">[[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]],</span> <span class="s1">&#39;bhsigmafrac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;polar_kick_angle&#39;</span> <span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;qcrit_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;cekickflag&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cehestarflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;cemergeflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ecsn&#39;</span> <span class="p">:</span> <span class="mf">2.25</span><span class="p">,</span> <span class="s1">&#39;ecsn_mlow&#39;</span> <span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ussn&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sigmadiv&#39;</span> <span class="p">:</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;qcflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;eddlimflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fprimc_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">],</span> <span class="s1">&#39;bhspinflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bhspinmag&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;rejuv_fac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;rejuvflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;htpmb&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_cr&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_tide&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bdecayfac&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rembar_massloss&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;kickflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;zsun&#39;</span> <span class="p">:</span> <span class="mf">0.014</span><span class="p">,</span> <span class="s1">&#39;bhms_coll_flag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;don_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<p>Once the binary is initialized and the BSE model is set, the system is evolved with the
the Evolve class, which calls the evolv2.f subroutine in the BSE source code.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span><span class="p">,</span> <span class="n">kick_info</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">single_binary</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">)</span>
</pre></div>
</div>
<p>For every evolved binary system, BSE generates two arrays, which are stored as pandas DataFrames in COSMIC:</p>
<ul class="simple">
<li><p>bpp - contains binary parameters at important stages in the binary’s evolution, including stellar evolutionary phase changes or mass transfer episodes.</p></li>
<li><p>bcm - contains several binary parameters at user specified time steps during the binary’s evolution. The default setting in COSMIC is to output the final stage of the binary at the evolution time specified by the user.</p></li>
</ul>
<p>You can see the different parameters included in each DataFrame using the columns attribute of the DataFrame:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bpp</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="go">Index([&#39;tphys&#39;, &#39;mass_1&#39;, &#39;mass_2&#39;, &#39;kstar_1&#39;, &#39;kstar_2&#39;, &#39;sep&#39;, &#39;porb&#39;, &#39;ecc&#39;,</span>
<span class="go">       &#39;RRLO_1&#39;, &#39;RRLO_2&#39;, &#39;evol_type&#39;, &#39;aj_1&#39;, &#39;aj_2&#39;, &#39;tms_1&#39;, &#39;tms_2&#39;,</span>
<span class="go">       &#39;massc_1&#39;, &#39;massc_2&#39;, &#39;rad_1&#39;, &#39;rad_2&#39;, &#39;mass0_1&#39;, &#39;mass0_2&#39;, &#39;lum_1&#39;,</span>
<span class="go">       &#39;lum_2&#39;, &#39;teff_1&#39;, &#39;teff_2&#39;, &#39;radc_1&#39;, &#39;radc_2&#39;, &#39;menv_1&#39;, &#39;menv_2&#39;,</span>
<span class="go">       &#39;renv_1&#39;, &#39;renv_2&#39;, &#39;omega_spin_1&#39;, &#39;omega_spin_2&#39;, &#39;B_1&#39;, &#39;B_2&#39;,</span>
<span class="go">       &#39;bacc_1&#39;, &#39;bacc_2&#39;, &#39;tacc_1&#39;, &#39;tacc_2&#39;, &#39;epoch_1&#39;, &#39;epoch_2&#39;,</span>
<span class="go">       &#39;bhspin_1&#39;, &#39;bhspin_2&#39;, &#39;bin_num&#39;],</span>
<span class="go">      dtype=&#39;object&#39;)</span>

<span class="gp">In [8]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bcm</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="go">Index([&#39;tphys&#39;, &#39;kstar_1&#39;, &#39;mass0_1&#39;, &#39;mass_1&#39;, &#39;lum_1&#39;, &#39;rad_1&#39;, &#39;teff_1&#39;,</span>
<span class="go">       &#39;massc_1&#39;, &#39;radc_1&#39;, &#39;menv_1&#39;, &#39;renv_1&#39;, &#39;epoch_1&#39;, &#39;omega_spin_1&#39;,</span>
<span class="go">       &#39;deltam_1&#39;, &#39;RRLO_1&#39;, &#39;kstar_2&#39;, &#39;mass0_2&#39;, &#39;mass_2&#39;, &#39;lum_2&#39;, &#39;rad_2&#39;,</span>
<span class="go">       &#39;teff_2&#39;, &#39;massc_2&#39;, &#39;radc_2&#39;, &#39;menv_2&#39;, &#39;renv_2&#39;, &#39;epoch_2&#39;,</span>
<span class="go">       &#39;omega_spin_2&#39;, &#39;deltam_2&#39;, &#39;RRLO_2&#39;, &#39;porb&#39;, &#39;sep&#39;, &#39;ecc&#39;, &#39;B_1&#39;,</span>
<span class="go">       &#39;B_2&#39;, &#39;SN_1&#39;, &#39;SN_2&#39;, &#39;bin_state&#39;, &#39;merger_type&#39;, &#39;bin_num&#39;],</span>
<span class="go">      dtype=&#39;object&#39;)</span>
</pre></div>
</div>
<p>The units are broadly consistent with BSE and are described in <a class="reference internal" href="../output_info/index.html#output-info"><span class="std std-ref">Describing the output of COSMIC/BSE: Columns names/Values/Units</span></a>.</p>
<p>The evol_type column in bpp indicates the evolutionary change that occurred for each line.
The meaning of each number is described here, <a class="reference internal" href="../output_info/index.html#evolve-type-table"><span class="std std-ref">Evolve Type</span></a>.</p>
<p>Each of the parameters in bpp or bcm can be accessed in the usual way for DataFrames:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">bpp</span><span class="o">.</span><span class="n">mass_1</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">0    85.543645</span>
<span class="go">0    72.720332</span>
<span class="go">0    72.589218</span>
<span class="go">0    71.959504</span>
<span class="go">0    32.352601</span>
<span class="go">0    32.176152</span>
<span class="go">0    25.488585</span>
<span class="go">0    24.988585</span>
<span class="go">0    24.988590</span>
<span class="go">0    24.989628</span>
<span class="go">0    24.990676</span>
<span class="go">0    24.990676</span>
<span class="go">0    24.990676</span>
<span class="go">0    24.990676</span>
<span class="go">0    24.990687</span>
<span class="go">0    24.990687</span>
<span class="go">0    24.990687</span>
<span class="go">Name: mass_1, dtype: float64</span>

<span class="gp">In [10]: </span><span class="n">bpp</span> <span class="o">=</span> <span class="n">bpp</span><span class="p">[[</span><span class="s1">&#39;mass_1&#39;</span><span class="p">,</span> <span class="s1">&#39;mass_2&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_1&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_2&#39;</span><span class="p">,</span> <span class="s1">&#39;sep&#39;</span><span class="p">,</span> <span class="s1">&#39;evol_type&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">utils.convert_kstar_evol_type</span></code> function to convert the
<code class="docutils literal notranslate"><span class="pre">kstar_1</span></code>, <code class="docutils literal notranslate"><span class="pre">kstar_2</span></code>, and <code class="docutils literal notranslate"><span class="pre">evol_type</span></code> columns from integers to strings
that describe each int:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="kn">from</span> <span class="nn">cosmic.utils</span> <span class="kn">import</span> <span class="n">convert_kstar_evol_type</span>

<span class="gp">In [12]: </span><span class="n">convert_kstar_evol_type</span><span class="p">(</span><span class="n">bpp</span><span class="p">)</span>
<span class="gh">Out[12]: </span><span class="go"></span>
<span class="go">      mass_1      mass_2               kstar_1               kstar_2          sep                  evol_type</span>
<span class="go">0  85.543645   84.997840          MS, &gt; 0.7 M⊙          MS, &gt; 0.7 M⊙  1363.435508              initial state</span>
<span class="go">0  72.720332   72.376321       Hertzsprung Gap          MS, &gt; 0.7 M⊙  1602.531512               kstar change</span>
<span class="go">0  72.589218   72.377845       Hertzsprung Gap          MS, &gt; 0.7 M⊙   883.827396  begin Roche lobe overflow</span>
<span class="go">0  71.959504   72.806393   Core Helium Burning          MS, &gt; 0.7 M⊙   882.511619               kstar change</span>
<span class="go">0  32.352601  110.573279   Core Helium Burning          MS, &gt; 0.7 M⊙  1614.251471     end Roche lobe overlow</span>
<span class="go">0  32.176152  110.618802  Naked Helium Star MS          MS, &gt; 0.7 M⊙  1614.063847               kstar change</span>
<span class="go">0  25.488585  106.891756  Naked Helium Star MS          MS, &gt; 0.7 M⊙  1741.069066       supernova of primary</span>
<span class="go">0  24.988585  106.891756            Black Hole          MS, &gt; 0.7 M⊙  1747.695130               kstar change</span>
<span class="go">0  24.988590   88.885767            Black Hole       Hertzsprung Gap  2023.280971               kstar change</span>
<span class="go">0  24.989628   88.681512            Black Hole       Hertzsprung Gap  2018.828817  begin Roche lobe overflow</span>
<span class="go">0  24.990676   88.469775            Black Hole   Core Helium Burning  2017.805217               kstar change</span>
<span class="go">0  24.990676   88.469775            Black Hole   Core Helium Burning  2017.805217      begin common envelope</span>
<span class="go">0  24.990676   41.981621            Black Hole  Naked Helium Star MS   320.660165        end common envelope</span>
<span class="go">0  24.990676   41.981621            Black Hole  Naked Helium Star MS   320.660165     end Roche lobe overlow</span>
<span class="go">0  24.990687   31.554344            Black Hole  Naked Helium Star MS   379.806762     supernova of secondary</span>
<span class="go">0  24.990687   31.054344            Black Hole            Black Hole   383.225670               kstar change</span>
<span class="go">0  24.990687   31.054344            Black Hole            Black Hole   382.989460         max evolution time</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">utils.convert_kstar_evol_type</span></code> is only applicable to the bpp
array.</p>
<p>You can also use the built in plotting function to see how the system evolves:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="kn">from</span> <span class="nn">cosmic.plotting</span> <span class="kn">import</span> <span class="n">evolve_and_plot</span>

<span class="gp">In [14]: </span><span class="n">single_binary</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">InitialBinaries</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="mf">85.543645</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="mf">84.99784</span><span class="p">,</span> <span class="n">porb</span><span class="o">=</span><span class="mf">446.795757</span><span class="p">,</span> <span class="n">ecc</span><span class="o">=</span><span class="mf">0.448872</span><span class="p">,</span> <span class="n">tphysf</span><span class="o">=</span><span class="mf">13700.0</span><span class="p">,</span> <span class="n">kstar1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kstar2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metallicity</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">BSEDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;bhflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;neta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;windflag&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;wdflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;pts1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;pts3&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;pts2&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;epsnov&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;hewind&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;ck&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;bwind&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lambdaf&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;mxns&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;tflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc2&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;grflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;remnantflag&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ceflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;eddfac&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ifflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bconst&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">265.0</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;pisn&#39;</span><span class="p">:</span> <span class="mf">45.0</span><span class="p">,</span> <span class="s1">&#39;natal_kick_array&#39;</span> <span class="p">:</span> <span class="p">[[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]],</span> <span class="s1">&#39;bhsigmafrac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;polar_kick_angle&#39;</span> <span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;qcrit_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;cekickflag&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cehestarflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;cemergeflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ecsn&#39;</span> <span class="p">:</span> <span class="mf">2.25</span><span class="p">,</span> <span class="s1">&#39;ecsn_mlow&#39;</span> <span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ussn&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sigmadiv&#39;</span> <span class="p">:</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;qcflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;eddlimflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fprimc_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">],</span> <span class="s1">&#39;bhspinflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bhspinmag&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;rejuv_fac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;rejuvflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;htpmb&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_cr&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_tide&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bdecayfac&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rembar_massloss&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;kickflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;zsun&#39;</span> <span class="p">:</span> <span class="mf">0.014</span><span class="p">,</span> <span class="s1">&#39;bhms_coll_flag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;don_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>

<span class="gp">In [16]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">evolve_and_plot</span><span class="p">(</span><span class="n">single_binary</span><span class="p">,</span> <span class="n">t_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">,</span> <span class="n">sys_obs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../examples/index-1.py">Source code</a>, <a class="reference external" href="../examples/index-1.png">png</a>, <a class="reference external" href="../examples/index-1.hires.png">hires.png</a>, <a class="reference external" href="../examples/index-1.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/index-1.png" class="plot-directive" src="../_images/index-1.png" />
</figure>
<p>In this case, all the action happens in the first few Myr, so let’s specify a t_max:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">evolve_and_plot</span><span class="p">(</span><span class="n">initC</span><span class="p">,</span> <span class="n">t_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="p">{},</span> <span class="n">sys_obs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../examples/index-2.py">Source code</a>, <a class="reference external" href="../examples/index-2.png">png</a>, <a class="reference external" href="../examples/index-2.hires.png">hires.png</a>, <a class="reference external" href="../examples/index-2.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="../_images/index-2.png" class="plot-directive" src="../_images/index-2.png" />
</figure>
</section>
<section id="multiple-binaries">
<h2>multiple binaries<a class="headerlink" href="#multiple-binaries" title="Permalink to this heading"></a></h2>
<p>Multiple systems can also be initialized and evolved; below is an example for systems
that could form GW150914 and GW170817 - like binaries.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">binary_set</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">InitialBinaries</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="p">[</span><span class="mf">85.543645</span><span class="p">,</span> <span class="mf">11.171469</span><span class="p">],</span> <span class="n">m2</span><span class="o">=</span><span class="p">[</span><span class="mf">84.99784</span><span class="p">,</span> <span class="mf">6.67305</span><span class="p">],</span> <span class="n">porb</span><span class="o">=</span><span class="p">[</span><span class="mf">446.795757</span><span class="p">,</span> <span class="mf">170.758343</span><span class="p">],</span> <span class="n">ecc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.448872</span><span class="p">,</span> <span class="mf">0.370</span><span class="p">],</span> <span class="n">tphysf</span><span class="o">=</span><span class="p">[</span><span class="mf">13700.0</span><span class="p">,</span> <span class="mf">13700.0</span><span class="p">],</span> <span class="n">kstar1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kstar2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">metallicity</span><span class="o">=</span><span class="p">[</span><span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>

<span class="gp">In [19]: </span><span class="nb">print</span><span class="p">(</span><span class="n">binary_set</span><span class="p">)</span>
<span class="go">   kstar_1  kstar_2     mass_1    mass_2        porb       ecc  metallicity   tphysf    mass0_1   mass0_2  rad_1  rad_2  lum_1  ...  B_2  bacc_1  bacc_2  tacc_1  tacc_2  epoch_1  epoch_2  tms_1  tms_2  bhspin_1  bhspin_2  tphys  binfrac</span>
<span class="go">0      1.0      1.0  85.543645  84.99784  446.795757  0.448872        0.002  13700.0  85.543645  84.99784    0.0    0.0    0.0  ...  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">1      1.0      1.0  11.171469   6.67305  170.758343  0.370000        0.020  13700.0  11.171469   6.67305    0.0    0.0    0.0  ...  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>

<span class="go">[2 rows x 38 columns]</span>

<span class="gp">In [20]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [21]: </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [22]: </span><span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span><span class="p">,</span> <span class="n">kick_info</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">binary_set</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the BSEDict did not be reinitialized since the BSE model did not change.</p>
<p>As before, bpp, bcm, and initC are returned as pandas DataFrames which assign an
index to each binary system we evolve. We can access each binary as follows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bpp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">        tphys     mass_1      mass_2  kstar_1  kstar_2          sep        porb       ecc        RRLO_1        RRLO_2  evol_type  ...  B_1  B_2  bacc_1  bacc_2  tacc_1  tacc_2   epoch_1   epoch_2  bhspin_1  bhspin_2  bin_num</span>
<span class="go">0    0.000000  85.543645   84.997840      1.0      1.0  1363.435508  446.795757  0.448872  3.878791e-02  3.877174e-02        1.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  0.000000  0.000000       0.0       0.0        0</span>
<span class="go">0    3.717070  72.719783   72.376037      2.0      1.0  1602.540712  617.246046  0.448872  1.074695e-01  1.299162e-01        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0 -0.130507 -0.129952       0.0       0.0        0</span>
<span class="go">0    3.718368  72.588666   72.377556      2.0      1.0   883.832613  252.926180  0.000000  1.000132e+00  1.268762e-01        3.0  ...  0.0  0.0     0.0     0.0     0.0     0.0 -0.130507 -0.129922       0.0       0.0        0</span>
<span class="go">0    3.720007  71.958903   72.806115      4.0      1.0   882.510342  252.534112  0.000000  1.686913e+01  1.504802e-01        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0 -0.130507 -0.101292       0.0       0.0        0</span>
<span class="go">0    3.739911  32.346795  110.583971      4.0      1.0  1616.153256  629.844167  0.000000  3.282858e-01  2.753324e-02        4.0  ...  0.0  0.0     0.0     0.0     0.0     0.0 -0.130507  1.466049       0.0       0.0        0</span>
<span class="go">0    3.741053  32.175552  110.600277      7.0      1.0  1617.101339  630.740428  0.000000  4.252227e-03  2.751049e-02        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  3.722851  1.466122       0.0       0.0        0</span>
<span class="go">0    4.071364  25.486398  106.874794      7.0      1.0  1744.364154  733.918026  0.000000  3.606448e-03  3.002358e-02       15.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  3.698581  1.447327       0.0       0.0        0</span>
<span class="go">0    4.071364  24.986398  106.874794     14.0      1.0  1751.003726  739.510366  0.003792  2.311299e-07  2.993589e-02        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  1.447327       0.0       0.0        0</span>
<span class="go">0    4.894907  24.986403   88.691971     14.0      2.0  2030.288753  994.420218  0.003792  1.895385e-07  4.575119e-02        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  1.289560       0.0       0.0        0</span>
<span class="go">0    4.896430  24.987444   88.487242     14.0      2.0  2025.833989  992.038312  0.000000  1.891237e-07  1.001885e+00        3.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  1.289560       0.0       0.0        0</span>
<span class="go">0    4.897383  24.988491   88.276317     14.0      4.0  2024.854520  992.236963  0.000000  1.891001e-07  6.931196e+00        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  1.289560       0.0       0.0        0</span>
<span class="go">0    4.897383  24.988491   88.276317     14.0      4.0  2024.854520  992.236963  0.000000  1.891001e-07  6.931196e+00        7.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  1.289560       0.0       0.0        0</span>
<span class="go">0    4.897383  24.988491   41.858050     14.0      7.0   320.766753   81.436052  0.000000  1.891001e-07  6.931196e+00        8.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  1.289560       0.0       0.0        0</span>
<span class="go">0    4.897383  24.988491   41.858050     14.0      7.0   320.766753   81.436052  0.000000  9.852501e-07  1.645015e-02        4.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  4.897383       0.0       0.0        0</span>
<span class="go">0    5.206247  24.988501   31.476750     14.0      7.0   379.755264  114.139832  0.000000  7.807651e-07  1.258480e-02       16.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  4.872584       0.0       0.0        0</span>
<span class="go">0    5.206247  24.988501   30.976750     14.0     14.0   383.178626  116.202332  0.008934  7.739647e-07  8.697561e-07        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  5.206247       0.0       0.0        0</span>
<span class="go">0  205.190000  24.988501   30.976750     14.0     14.0   382.959826  116.102817  0.008934  7.744068e-07  8.702530e-07       10.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  4.071364  5.206247       0.0       0.0        0</span>

<span class="go">[17 rows x 44 columns]</span>

<span class="gp">In [24]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bcm</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">     tphys  kstar_1    mass0_1     mass_1         lum_1      rad_1        teff_1    massc_1    radc_1        menv_1        renv_1  ...        RRLO_2        porb          sep       ecc  B_1  B_2  SN_1  SN_2  bin_state  merger_type  bin_num</span>
<span class="go">0     0.00      1.0  85.543645  85.543645  9.416137e+05  11.060285  54306.854457   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  3.877174e-02  446.795757  1363.435508  0.448872  0.0  0.0   0.0   0.0          0         -001        0</span>
<span class="go">0     0.01      1.0  85.527367  85.527367  9.423653e+05  11.069603  54294.820398   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  3.879707e-02  446.965185  1363.693996  0.448872  0.0  0.0   0.0   0.0          0         -001        0</span>
<span class="go">0     0.02      1.0  85.511049  85.511049  9.431226e+05  11.078928  54282.866439   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  3.882240e-02  447.135124  1363.953214  0.448872  0.0  0.0   0.0   0.0          0         -001        0</span>
<span class="go">0     0.03      1.0  85.494691  85.494691  9.438858e+05  11.088262  54270.989379   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  3.884773e-02  447.305577  1364.213166  0.448872  0.0  0.0   0.0   0.0          0         -001        0</span>
<span class="go">0     0.04      1.0  85.478292  85.478292  9.446548e+05  11.097605  54259.186024   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  3.887306e-02  447.476547  1364.473858  0.448872  0.0  0.0   0.0   0.0          0         -001        0</span>
<span class="go">..     ...      ...        ...        ...           ...        ...           ...        ...       ...           ...           ...  ...           ...         ...          ...       ...  ...  ...   ...   ...        ...          ...      ...</span>
<span class="go">0   205.15     14.0  25.486398  24.988501  1.000000e-10   0.000106   1781.215957  24.988501  0.000106  1.000000e-10  1.000000e-10  ...  8.702530e-07  116.102817   382.959826  0.008934  0.0  0.0   1.0   1.0          0         -001        0</span>
<span class="go">0   205.16     14.0  25.486398  24.988501  1.000000e-10   0.000106   1781.215957  24.988501  0.000106  1.000000e-10  1.000000e-10  ...  8.702530e-07  116.102817   382.959826  0.008934  0.0  0.0   1.0   1.0          0         -001        0</span>
<span class="go">0   205.17     14.0  25.486398  24.988501  1.000000e-10   0.000106   1781.215957  24.988501  0.000106  1.000000e-10  1.000000e-10  ...  8.702530e-07  116.102817   382.959826  0.008934  0.0  0.0   1.0   1.0          0         -001        0</span>
<span class="go">0   205.18     14.0  25.486398  24.988501  1.000000e-10   0.000106   1781.215957  24.988501  0.000106  1.000000e-10  1.000000e-10  ...  8.702530e-07  116.102817   382.959826  0.008934  0.0  0.0   1.0   1.0          0         -001        0</span>
<span class="go">0   205.19     14.0  25.486398  24.988501  1.000000e-10   0.000106   1781.215957  24.988501  0.000106  1.000000e-10  1.000000e-10  ...  8.702530e-07  116.102817   382.959826  0.008934  0.0  0.0   1.0   1.0          0         -001        0</span>

<span class="go">[20520 rows x 39 columns]</span>

<span class="gp">In [25]: </span><span class="nb">print</span><span class="p">(</span><span class="n">initC</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">kstar_1        1.000000</span>
<span class="go">kstar_2        1.000000</span>
<span class="go">mass_1        85.543645</span>
<span class="go">mass_2        84.997840</span>
<span class="go">porb         446.795757</span>
<span class="go">                ...    </span>
<span class="go">fprimc_11      0.095238</span>
<span class="go">fprimc_12      0.095238</span>
<span class="go">fprimc_13      0.095238</span>
<span class="go">fprimc_14      0.095238</span>
<span class="go">fprimc_15      0.095238</span>
<span class="go">Name: 0, Length: 136, dtype: float64</span>

<span class="gp">In [26]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bpp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">        tphys     mass_1    mass_2  kstar_1  kstar_2         sep        porb       ecc     RRLO_1    RRLO_2  evol_type  ...  B_1           B_2  bacc_1  bacc_2  tacc_1  tacc_2    epoch_1    epoch_2  bhspin_1  bhspin_2  bin_num</span>
<span class="go">1    0.000000  11.171469  6.673050      1.0      1.0  338.356712  170.758343  0.370000   0.049210  0.045915        1.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0   0.000000   0.000000       0.0       0.0        1</span>
<span class="go">1   19.427278  10.767909  6.664658      2.0      1.0  346.350714  178.922774  0.369999   0.115026  0.053609        2.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  -0.969072  -0.029132       0.0       0.0        1</span>
<span class="go">1   19.461438  10.765777  6.664702      2.0      1.0  218.223971   89.489313  0.000000   1.000479  0.053622        3.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  -0.976313  -0.028841       0.0       0.0        1</span>
<span class="go">1   19.476912  10.544417  6.884988      3.0      1.0  211.992707   85.686473  0.000000   2.771636  0.055156        2.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  -1.094470   1.906517       0.0       0.0        1</span>
<span class="go">1   19.476912  10.544417  6.884988      3.0      1.0  211.992707   85.686473  0.000000   2.771636  0.055156        7.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  -1.094470   1.906517       0.0       0.0        1</span>
<span class="go">1   19.476912   2.415442  6.884988      7.0      1.0   20.150243    3.437487  0.000000   2.771636  0.055156        8.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  -1.094470   1.906517       0.0       0.0        1</span>
<span class="go">1   19.476912   2.415442  6.884988      7.0      1.0   20.150243    3.437487  0.000000   0.064435  0.421709        4.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  19.476912   1.906517       0.0       0.0        1</span>
<span class="go">1   22.952681   2.226294  6.887974      8.0      1.0   20.614122    3.593011  0.000000   0.060956  0.424422        2.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  19.165010   1.925371       0.0       0.0        1</span>
<span class="go">1   23.231406   2.177806  6.896735      8.0      1.0   20.656641    3.612014  0.000000   1.000105  0.423629        3.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  19.165010   1.984764       0.0       0.0        1</span>
<span class="go">1   23.254641   1.889676  7.181936      9.0      1.0   22.458960    4.095570  0.000000  25.240301  0.382091        2.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  19.165010   4.538299       0.0       0.0        1</span>
<span class="go">1   23.256935   1.371085  7.700471      9.0      1.0   31.223370    6.713530  0.000000   0.274471  0.263521        4.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  19.165010   8.211818       0.0       0.0        1</span>
<span class="go">1   23.258694   1.370344  7.700740     12.0      1.0   31.223233    6.713660  0.000000   0.000146  0.263511        2.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  23.258694   8.212927       0.0       0.0        1</span>
<span class="go">1   47.641575   1.370365  7.628335     12.0      2.0   32.650896    7.208168  0.000000   0.000139  0.483936        2.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  23.258694   7.614577       0.0       0.0        1</span>
<span class="go">1   47.673758   1.370368  7.628122     12.0      2.0   32.703941    7.225825  0.000000   0.000139  1.000649        3.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  23.258694   7.612219       0.0       0.0        1</span>
<span class="go">1   47.673758   1.370368  7.628122     12.0      2.0   32.703941    7.225825  0.000000   0.000139  1.000649        7.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  23.258694   7.612219       0.0       0.0        1</span>
<span class="go">1   47.673758   1.370344  8.188112     15.0      5.0    0.000000    0.000000  0.000000   0.000139  1.000649        8.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  23.258694   7.612219       0.0       0.0        1</span>
<span class="go">1   47.785623   0.000000  7.998227     15.0      5.0    0.000000    0.000000 -1.000000  -1.000000  0.000100       16.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  23.258694  21.502403       0.0       0.0        1</span>
<span class="go">1   47.785623   0.000000  1.277584     15.0     13.0    0.000000    0.000000 -1.000000  -1.000000  0.000100        2.0  ...  0.0  0.000000e+00     0.0     0.0     0.0     0.0  23.258694  47.785623       0.0       0.0        1</span>
<span class="go">1  247.770000   0.000000  1.277584     15.0     13.0    0.000000    0.000000 -1.000000  -1.000000  0.000100       10.0  ...  0.0  5.688661e+12     0.0     0.0     0.0     0.0  23.258694  47.785623       0.0       0.0        1</span>

<span class="go">[19 rows x 44 columns]</span>
</pre></div>
</div>
<p>The plotting function can also take in multiple binaries. Let’s plot both the GW150914-like
progenitor evolution and the GW170817-like progenitor evolutions. For the GW170817-like
progenitor, we expect most of the evolution to take place in the first ~60 Myr.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [27]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">evolve_and_plot</span><span class="p">(</span><span class="n">binary_set</span><span class="p">,</span> <span class="n">t_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_max</span><span class="o">=</span><span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">],</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">,</span> <span class="n">sys_obs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../examples/index-3.py">Source code</a>)</p>
<figure class="align-default" id="id1">
<img alt="../_images/index-3_00.png" class="plot-directive" src="../_images/index-3_00.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference external" href="../examples/index-3_00.png">png</a>, <a class="reference external" href="../examples/index-3_00.hires.png">hires.png</a>, <a class="reference external" href="../examples/index-3_00.pdf">pdf</a>)</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<img alt="../_images/index-3_01.png" class="plot-directive" src="../_images/index-3_01.png" />
<figcaption>
<p><span class="caption-text">(<a class="reference external" href="../examples/index-3_01.png">png</a>, <a class="reference external" href="../examples/index-3_01.hires.png">hires.png</a>, <a class="reference external" href="../examples/index-3_01.pdf">pdf</a>)</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="grid-of-binaries">
<h2>grid of binaries<a class="headerlink" href="#grid-of-binaries" title="Permalink to this heading"></a></h2>
<p>Sometimes it is helpful to run a grid of initial binaries to explore how
changing a single paramter affects the evolved binary. Here we evolve
the same system that produces a GW150914-like binary, but run over several initial orbital
periods spaced evenly in log space.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">n_grid</span> <span class="o">=</span> <span class="mi">10</span>

<span class="gp">In [29]: </span><span class="n">binary_grid</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">InitialBinaries</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span><span class="o">*</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span><span class="o">*</span><span class="mf">85.0</span><span class="p">,</span> <span class="n">porb</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">n_grid</span><span class="p">),</span> <span class="n">ecc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span><span class="o">*</span><span class="mf">0.65</span><span class="p">,</span> <span class="n">tphysf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span><span class="o">*</span><span class="mf">13700.0</span><span class="p">,</span> <span class="n">kstar1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_grid</span><span class="p">),</span> <span class="n">kstar2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_grid</span><span class="p">),</span> <span class="n">metallicity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_grid</span><span class="p">)</span><span class="o">*</span><span class="mf">0.005</span><span class="p">)</span>

<span class="gp">In [30]: </span><span class="n">BSEDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;bhflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;neta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;windflag&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;wdflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;pts1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;pts3&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;pts2&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;epsnov&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;hewind&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;ck&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;bwind&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lambdaf&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;mxns&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;tflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc2&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;grflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;remnantflag&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ceflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;eddfac&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ifflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bconst&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">265.0</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;pisn&#39;</span><span class="p">:</span> <span class="mf">45.0</span><span class="p">,</span> <span class="s1">&#39;natal_kick_array&#39;</span> <span class="p">:</span> <span class="p">[[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]],</span> <span class="s1">&#39;bhsigmafrac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;polar_kick_angle&#39;</span> <span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;qcrit_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;cekickflag&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cehestarflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;cemergeflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ecsn&#39;</span> <span class="p">:</span> <span class="mf">2.25</span><span class="p">,</span> <span class="s1">&#39;ecsn_mlow&#39;</span> <span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ussn&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sigmadiv&#39;</span> <span class="p">:</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;qcflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;eddlimflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fprimc_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">],</span> <span class="s1">&#39;bhspinflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bhspinmag&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;rejuv_fac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;rejuvflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;htpmb&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_cr&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_tide&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bdecayfac&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rembar_massloss&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;kickflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;zsun&#39;</span> <span class="p">:</span> <span class="mf">0.014</span><span class="p">,</span> <span class="s1">&#39;bhms_coll_flag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;don_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>

<span class="gp">In [31]: </span><span class="nb">print</span><span class="p">(</span><span class="n">binary_grid</span><span class="p">)</span>
<span class="go">   kstar_1  kstar_2  mass_1  mass_2           porb   ecc  metallicity   tphysf  mass0_1  mass0_2  rad_1  rad_2  lum_1  lum_2  ...  B_1  B_2  bacc_1  bacc_2  tacc_1  tacc_2  epoch_1  epoch_2  tms_1  tms_2  bhspin_1  bhspin_2  tphys  binfrac</span>
<span class="go">0      1.0      1.0   100.0    85.0    1000.000000  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">1      1.0      1.0   100.0    85.0    1668.100537  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">2      1.0      1.0   100.0    85.0    2782.559402  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">3      1.0      1.0   100.0    85.0    4641.588834  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">4      1.0      1.0   100.0    85.0    7742.636827  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">5      1.0      1.0   100.0    85.0   12915.496650  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">6      1.0      1.0   100.0    85.0   21544.346900  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">7      1.0      1.0   100.0    85.0   35938.136638  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">8      1.0      1.0   100.0    85.0   59948.425032  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>
<span class="go">9      1.0      1.0   100.0    85.0  100000.000000  0.65        0.005  13700.0    100.0     85.0    0.0    0.0    0.0    0.0  ...  0.0  0.0     0.0     0.0     0.0     0.0      0.0      0.0    0.0    0.0       0.0       0.0    0.0      1.0</span>

<span class="go">[10 rows x 38 columns]</span>

<span class="gp">In [32]: </span><span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span><span class="p">,</span> <span class="n">kick_info</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">binary_grid</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">)</span>

<span class="gp">In [33]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bpp</span><span class="p">)</span>
<span class="go">           tphys      mass_1     mass_2  kstar_1  kstar_2            sep          porb       ecc        RRLO_1        RRLO_2  evol_type  ...  B_1  B_2  bacc_1  bacc_2  tacc_1  tacc_2   epoch_1   epoch_2  bhspin_1  bhspin_2  bin_num</span>
<span class="go">0       0.000000  100.000000  85.000000      1.0      1.0    2397.042879  1.000000e+03  0.650000  4.214342e-02  4.122696e-02        1.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  0.000000  0.000000       0.0       0.0        0</span>
<span class="go">0       3.561836   74.433283  67.900444      2.0      1.0    3115.630394  1.689418e+03  0.650000  1.241381e-01  1.262321e-01        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0 -0.192142 -0.163778       0.0       0.0        0</span>
<span class="go">0       3.563725   74.195874  67.901480      2.0      1.0    1092.094610  3.508888e+02  0.000000  1.001714e+00  1.263648e-01        3.0  ...  0.0  0.0     0.0     0.0     0.0     0.0 -0.192142 -0.163756       0.0       0.0        0</span>
<span class="go">0       3.564957   73.978352  67.965270      4.0      1.0    1091.881014  3.509758e+02  0.000000  3.925547e+00  1.263083e-01        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0 -0.192142 -0.160638       0.0       0.0        0</span>
<span class="go">0       3.656147   34.358643  98.037335      4.0      1.0    1408.149978  5.322408e+02  0.000000  6.132831e-01  4.403118e-02        4.0  ...  0.0  0.0     0.0     0.0     0.0     0.0 -0.192142  1.156534       0.0       0.0        0</span>
<span class="go">..           ...         ...        ...      ...      ...            ...           ...       ...           ...           ...        ...  ...  ...  ...     ...     ...     ...     ...       ...       ...       ...       ...      ...</span>
<span class="go">9       3.930319   28.153730  35.520384     14.0      4.0  146504.333172  8.144537e+05  0.645026  6.394120e-09  9.156138e-02        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  3.930319 -0.176003       0.0       0.0        9</span>
<span class="go">9       3.960762   28.159125  31.484483     14.0      7.0  156308.745072  9.273958e+05  0.644909  5.824845e-09  9.079288e-05        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  3.930319  3.758602       0.0       0.0        9</span>
<span class="go">9       4.100892   28.159125  24.732495     14.0      7.0  176275.664624  1.179417e+06  0.644909  5.824845e-09  9.079288e-05       16.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  3.930319  3.722109       0.0       0.0        9</span>
<span class="go">9       4.100892   28.159125  24.232495     14.0     14.0  178591.634598  1.208462e+06  0.646513  4.824793e-09  4.446878e-09        2.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  3.930319  4.100892       0.0       0.0        9</span>
<span class="go">9   13700.000000   28.159125  24.232495     14.0     14.0  178489.776222  1.207428e+06  0.646513  4.827546e-09  4.449415e-09       10.0  ...  0.0  0.0     0.0     0.0     0.0     0.0  3.930319  4.100892       0.0       0.0        9</span>

<span class="go">[140 rows x 44 columns]</span>

<span class="gp">In [34]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bcm</span><span class="p">)</span>
<span class="go">     tphys  kstar_1     mass0_1      mass_1         lum_1      rad_1        teff_1    massc_1    radc_1        menv_1        renv_1  ...        RRLO_2          porb            sep       ecc  B_1  B_2  SN_1  SN_2  bin_state  merger_type  bin_num</span>
<span class="go">0      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  4.122696e-02  1.000000e+03    2397.042879  0.650000  0.0  0.0   0.0   0.0          0         -001        0</span>
<span class="go">0  13700.0     14.0   22.440552   21.943153  1.000000e-10   0.000093   1900.803264  21.943153  0.000093  1.000000e-10  1.000000e-10  ...  1.865774e-06  2.458504e+01     123.469509  0.011920  0.0  0.0   1.0   1.0          0         -001        0</span>
<span class="go">1      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  2.931117e-02  1.668101e+03    3371.506109  0.650000  0.0  0.0   0.0   0.0          0         -001        1</span>
<span class="go">1  13700.0     14.0   23.651593   23.154215  1.000000e-10   0.000098   1850.425698  23.154215  0.000098  1.000000e-10  1.000000e-10  ...  1.788960e-06  2.619483e+01     129.953548  0.011609  0.0  0.0   1.0   1.0          0         -001        1</span>
<span class="go">2      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  2.083939e-02  2.782559e+03    4742.115190  0.650000  0.0  0.0   0.0   0.0          0         -001        2</span>
<span class="go">2  13700.0     14.0   25.319576   25.079267  1.000000e-10   0.000106   1777.989786  25.079267  0.000106  1.000000e-10  1.000000e-10  ...  1.029859e-07  2.555575e+03    2943.446752  0.009533  0.0  0.0   1.0   1.0          0         -001        2</span>
<span class="go">3      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  1.481620e-02  4.641589e+03    6669.914200  0.650000  0.0  0.0   0.0   0.0          0         -001        3</span>
<span class="go">3  13700.0     14.0   27.066154   26.858148  1.000000e-10   0.000114   1718.100835  26.858148  0.000114  1.000000e-10  1.000000e-10  ...  8.746688e-08  3.389138e+03    3613.904203  0.009059  0.0  0.0   1.0   1.0          0         -001        3</span>
<span class="go">4      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  1.053389e-02  7.742637e+03    9381.416025  0.650000  0.0  0.0   0.0   0.0          0         -001        4</span>
<span class="go">4  13700.0     14.0   24.723822   24.223941  1.000000e-10   0.000103   1809.107130  24.223941  0.000103  1.000000e-10  1.000000e-10  ...  1.280214e-06  4.279488e+01     181.050323  0.017606  0.0  0.0   1.0   1.0          0         -001        4</span>
<span class="go">5      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  7.489289e-03  1.291550e+04   13195.217208  0.650000  0.0  0.0   0.0   0.0          0         -001        5</span>
<span class="go">5  13700.0     14.0   29.517261   29.070916  1.000000e-10   0.000123   1651.419177  29.070916  0.000123  1.000000e-10  1.000000e-10  ...  2.158945e-08  6.521852e+04   25850.016841  0.473375  0.0  0.0   1.0   1.0          0         -001        5</span>
<span class="go">6      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  5.324667e-03  2.154435e+04   18559.432469  0.650000  0.0  0.0   0.0   0.0          0         -001        6</span>
<span class="go">6  13700.0     14.0   28.990549   28.531297  1.000000e-10   0.000121   1666.962868  28.531297  0.000121  1.000000e-10  1.000000e-10  ...  1.356464e-08  1.951836e+05   53258.251279  0.604085  0.0  0.0   1.0   1.0          0         -001        6</span>
<span class="go">7      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  3.785684e-03  3.593814e+04   26104.347365  0.650000  0.0  0.0   0.0   0.0          0         -001        7</span>
<span class="go">7  13700.0     14.0   28.809440   28.333276  1.000000e-10   0.000120   1672.777925  28.333276  0.000120  1.000000e-10  1.000000e-10  ...  9.238461e-09  3.844055e+05   83492.641891  0.631604  0.0  0.0   1.0   1.0          0         -001        7</span>
<span class="go">8      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  2.691511e-03  5.994843e+04   36716.475706  0.650000  0.0  0.0   0.0   0.0          0         -001        8</span>
<span class="go">8  13700.0     14.0   28.708663   28.219714  1.000000e-10   0.000120   1676.140336  28.219714  0.000120  1.000000e-10  1.000000e-10  ...  6.306465e-09  6.873549e+05  122635.915245  0.637013  0.0  0.0   1.0   1.0          0         -001        8</span>
<span class="go">9      0.0      1.0  100.000000  100.000000  1.240906e+06  13.897608  51907.996879   0.000000  0.000000  1.000000e-10  1.000000e-10  ...  1.913586e-03  1.000000e+05   51642.723315  0.650000  0.0  0.0   0.0   0.0          0         -001        9</span>
<span class="go">9  13700.0     14.0   28.653730   28.159125  1.000000e-10   0.000119   1677.942604  28.159125  0.000119  1.000000e-10  1.000000e-10  ...  4.449415e-09  1.207428e+06  178489.776222  0.646513  0.0  0.0   1.0   1.0          0         -001        9</span>

<span class="go">[20 rows x 39 columns]</span>
</pre></div>
</div>
</section>
<section id="dynamically-set-time-resolution-for-bcm-array">
<h2>dynamically set time resolution for bcm array<a class="headerlink" href="#dynamically-set-time-resolution-for-bcm-array" title="Permalink to this heading"></a></h2>
<p>COSMIC has the ability to set time resolution of the bcm array depending on the current state of the evolution. Below we demonstrate three scenarios, setting dtp only during mass transfer, setting dtp to the same resolution for all of the evolution except for after the system merges or is disrupted, and finally an example of setting dtp only during the HMB stage of the evolution.</p>
<p>First, print all time steps during mass transfer</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">single_binary</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">InitialBinaries</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="mf">7.806106</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="mf">5.381412</span><span class="p">,</span> <span class="n">porb</span><span class="o">=</span><span class="mf">2858.942021</span><span class="p">,</span> <span class="n">ecc</span><span class="o">=</span><span class="mf">0.601408</span><span class="p">,</span> <span class="n">tphysf</span><span class="o">=</span><span class="mf">13700.0</span><span class="p">,</span> <span class="n">kstar1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kstar2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metallicity</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>

<span class="gp">In [36]: </span><span class="n">BSEDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;bhflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;neta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;windflag&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;wdflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;pts1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;pts3&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;pts2&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;epsnov&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;hewind&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;ck&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;bwind&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lambdaf&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;mxns&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;tflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc2&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;grflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;remnantflag&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ceflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;eddfac&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ifflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bconst&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">265.0</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;pisn&#39;</span><span class="p">:</span> <span class="mf">45.0</span><span class="p">,</span> <span class="s1">&#39;natal_kick_array&#39;</span> <span class="p">:</span> <span class="p">[[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]],</span> <span class="s1">&#39;bhsigmafrac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;polar_kick_angle&#39;</span> <span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;qcrit_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;cekickflag&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cehestarflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;cemergeflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ecsn&#39;</span> <span class="p">:</span> <span class="mf">2.25</span><span class="p">,</span> <span class="s1">&#39;ecsn_mlow&#39;</span> <span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ussn&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sigmadiv&#39;</span> <span class="p">:</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;qcflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;eddlimflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fprimc_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">],</span> <span class="s1">&#39;bhspinflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bhspinmag&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;rejuv_fac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;rejuvflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;htpmb&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_cr&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_tide&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bdecayfac&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rembar_massloss&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;kickflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;zsun&#39;</span> <span class="p">:</span> <span class="mf">0.014</span><span class="p">,</span> <span class="s1">&#39;bhms_coll_flag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;don_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>

<span class="gp">In [37]: </span><span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span><span class="p">,</span> <span class="n">kick_info</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">single_binary</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">,</span> <span class="n">timestep_conditions</span> <span class="o">=</span><span class="p">[[</span><span class="s1">&#39;RRLO_1&gt;=1&#39;</span><span class="p">,</span> <span class="s1">&#39;dtp=0.0&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;RRLO_2&gt;=1&#39;</span><span class="p">,</span> <span class="s1">&#39;dtp=0.0&#39;</span><span class="p">]])</span>

<span class="gp">In [38]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bcm</span><span class="p">[[</span><span class="s1">&#39;tphys&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_1&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_2&#39;</span><span class="p">,</span> <span class="s1">&#39;mass_1&#39;</span><span class="p">,</span> <span class="s1">&#39;mass_2&#39;</span><span class="p">,</span> <span class="s1">&#39;RRLO_1&#39;</span><span class="p">,</span> <span class="s1">&#39;RRLO_2&#39;</span><span class="p">]])</span>
<span class="go">           tphys  kstar_1  kstar_2    mass_1    mass_2    RRLO_1    RRLO_2</span>
<span class="go">0       0.000000      1.0      1.0  7.806106  5.381412  0.010953  0.010459</span>
<span class="go">0      43.565604      5.0      1.0  7.346069  5.396914  1.000222  0.008730</span>
<span class="go">0      43.565604      8.0      1.0  2.037972  5.396914  0.520417  0.110930</span>
<span class="go">0      43.579670      8.0      1.0  2.032299  5.399465  1.000951  0.110963</span>
<span class="go">0      43.579674      8.0      1.0  2.032297  5.399466  1.001137  0.110963</span>
<span class="go">..           ...      ...      ...       ...       ...       ...       ...</span>
<span class="go">0      43.610746      9.0      1.0  1.323823  6.103425  1.704861  0.064712</span>
<span class="go">0      43.611735      9.0      1.0  1.322435  6.104787  0.033876  0.064677</span>
<span class="go">0      80.634129     12.0      2.0  1.321769  6.083292  0.000090  1.000175</span>
<span class="go">0      80.634129     15.0      5.0  0.000000  5.225974 -1.000000  0.000100</span>
<span class="go">0   13700.000000     15.0     13.0  0.000000  1.277584 -1.000000  0.000100</span>

<span class="go">[107 rows x 7 columns]</span>
</pre></div>
</div>
<p>Second, pick a certain resolution for the bcm array until the system mergers or is disrutped and then only print the final state</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span><span class="p">,</span> <span class="n">kick_info</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">single_binary</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">,</span> <span class="n">timestep_conditions</span> <span class="o">=</span><span class="p">[[</span><span class="s1">&#39;binstate=0&#39;</span><span class="p">,</span> <span class="s1">&#39;dtp=1.0&#39;</span><span class="p">]])</span>

<span class="gp">In [40]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bcm</span><span class="p">[[</span><span class="s1">&#39;tphys&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_1&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_2&#39;</span><span class="p">,</span> <span class="s1">&#39;mass_1&#39;</span><span class="p">,</span> <span class="s1">&#39;mass_2&#39;</span><span class="p">,</span> <span class="s1">&#39;bin_state&#39;</span><span class="p">]])</span>
<span class="go">      tphys  kstar_1  kstar_2    mass_1    mass_2  bin_state</span>
<span class="go">0       0.0      1.0      1.0  7.806106  5.381412          0</span>
<span class="go">0       1.0      1.0      1.0  7.805049  5.381334          0</span>
<span class="go">0       2.0      1.0      1.0  7.803970  5.381256          0</span>
<span class="go">0       3.0      1.0      1.0  7.802864  5.381177          0</span>
<span class="go">0       4.0      1.0      1.0  7.801731  5.381097          0</span>
<span class="go">..      ...      ...      ...       ...       ...        ...</span>
<span class="go">0      78.0     12.0      1.0  1.321764  6.085939          0</span>
<span class="go">0      79.0     12.0      1.0  1.321764  6.085078          0</span>
<span class="go">0      80.0     12.0      1.0  1.321764  6.084196          0</span>
<span class="go">0      81.0     15.0     13.0  0.000000  1.277584          1</span>
<span class="go">0   13700.0     15.0     13.0  0.000000  1.277584          1</span>

<span class="go">[83 rows x 6 columns]</span>
</pre></div>
</div>
<p>Finally, we show how to print a fine resolution only during the HMXB stage of the evolution.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [41]: </span><span class="n">single_binary</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">InitialBinaries</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="mf">85.543645</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="mf">84.99784</span><span class="p">,</span> <span class="n">porb</span><span class="o">=</span><span class="mf">446.795757</span><span class="p">,</span> <span class="n">ecc</span><span class="o">=</span><span class="mf">0.448872</span><span class="p">,</span> <span class="n">tphysf</span><span class="o">=</span><span class="mf">13700.0</span><span class="p">,</span> <span class="n">kstar1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kstar2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metallicity</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>

<span class="gp">In [42]: </span><span class="n">BSEDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;bhflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;neta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;windflag&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;wdflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;pts1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;pts3&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;pts2&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;epsnov&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;hewind&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;ck&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;bwind&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lambdaf&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;mxns&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;tflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc2&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;grflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;remnantflag&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ceflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;eddfac&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ifflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bconst&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">265.0</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;pisn&#39;</span><span class="p">:</span> <span class="mf">45.0</span><span class="p">,</span> <span class="s1">&#39;natal_kick_array&#39;</span> <span class="p">:</span> <span class="p">[[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]],</span> <span class="s1">&#39;bhsigmafrac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;polar_kick_angle&#39;</span> <span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;qcrit_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;cekickflag&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cehestarflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;cemergeflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ecsn&#39;</span> <span class="p">:</span> <span class="mf">2.25</span><span class="p">,</span> <span class="s1">&#39;ecsn_mlow&#39;</span> <span class="p">:</span> <span class="mf">1.6</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ussn&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sigmadiv&#39;</span> <span class="p">:</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;qcflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;eddlimflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fprimc_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">],</span> <span class="s1">&#39;bhspinflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bhspinmag&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;rejuv_fac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;rejuvflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;htpmb&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_cr&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_tide&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bdecayfac&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rembar_massloss&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;kickflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;zsun&#39;</span> <span class="p">:</span> <span class="mf">0.014</span><span class="p">,</span> <span class="s1">&#39;bhms_coll_flag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;don_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>

<span class="gp">In [43]: </span><span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span><span class="p">,</span> <span class="n">kick_info</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">single_binary</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">,</span> <span class="n">timestep_conditions</span> <span class="o">=</span><span class="p">[[</span><span class="s1">&#39;kstar_1=14&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_2&lt;10&#39;</span><span class="p">,</span><span class="s1">&#39;dtp=0.1&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;kstar_2=14&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_1&lt;10&#39;</span><span class="p">,</span><span class="s1">&#39;dtp=0.1&#39;</span><span class="p">]])</span>

<span class="gp">In [44]: </span><span class="nb">print</span><span class="p">(</span><span class="n">bcm</span><span class="p">[[</span><span class="s1">&#39;tphys&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_1&#39;</span><span class="p">,</span> <span class="s1">&#39;kstar_2&#39;</span><span class="p">,</span> <span class="s1">&#39;mass_1&#39;</span><span class="p">,</span> <span class="s1">&#39;mass_2&#39;</span><span class="p">,</span> <span class="s1">&#39;bin_state&#39;</span><span class="p">]])</span>
<span class="go">          tphys  kstar_1  kstar_2     mass_1      mass_2  bin_state</span>
<span class="go">0      0.000000      1.0      1.0  85.543645   84.997840          0</span>
<span class="go">0      4.071374     14.0      1.0  24.988585  106.891756          0</span>
<span class="go">0      4.171374     14.0      1.0  24.988586  105.634889          0</span>
<span class="go">0      4.271374     14.0      1.0  24.988586  104.335873          0</span>
<span class="go">0      4.371374     14.0      1.0  24.988586  103.016130          0</span>
<span class="go">0      4.471374     14.0      1.0  24.988586  101.707633          0</span>
<span class="go">0      4.571374     14.0      1.0  24.988586  100.454871          0</span>
<span class="go">0      4.671374     14.0      1.0  24.988586   99.314847          0</span>
<span class="go">0      4.771374     14.0      1.0  24.988586   98.352198          0</span>
<span class="go">0      4.871374     14.0      1.0  24.988590   89.040292          0</span>
<span class="go">0      4.971374     14.0      7.0  24.990678   39.441122          0</span>
<span class="go">0      5.071374     14.0      7.0  24.990681   35.988161          0</span>
<span class="go">0      5.171374     14.0      7.0  24.990685   32.642016          0</span>
<span class="go">0      5.271374     14.0     14.0  24.990687   31.054448          0</span>
<span class="go">0  13700.000000     14.0     14.0  24.990687   31.054448          0</span>
</pre></div>
</div>
</section>
<section id="restarting-a-binary">
<h2>restarting a binary<a class="headerlink" href="#restarting-a-binary" title="Permalink to this heading"></a></h2>
<p>COSMIC allows you to restart a binary from any point in its evolution from a COSMIC generated bpp array.
Below we provide an example of the same evolutionary track
started from the beginning and three different points in the evolution, once sometime between the beginning and the first object going supernova, once between the first and second supernova, and finally after both supernova</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">single_binary</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">InitialBinaries</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="mf">25.543645</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="mf">20.99784</span><span class="p">,</span> <span class="n">porb</span><span class="o">=</span><span class="mf">446.795757</span><span class="p">,</span> <span class="n">ecc</span><span class="o">=</span><span class="mf">0.448872</span><span class="p">,</span> <span class="n">tphysf</span><span class="o">=</span><span class="mf">13700.0</span><span class="p">,</span> <span class="n">kstar1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kstar2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metallicity</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
<span class="n">BSEDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;bhflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;neta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;windflag&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;wdflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;pts1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;pts3&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;pts2&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;epsnov&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;hewind&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;ck&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;bwind&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lambdaf&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;mxns&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;tflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc2&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;remnantflag&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ceflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;eddfac&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ifflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bconst&#39;</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">265.0</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;pisn&#39;</span><span class="p">:</span> <span class="mf">45.0</span><span class="p">,</span> <span class="s1">&#39;natal_kick_array&#39;</span> <span class="p">:</span> <span class="p">[[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]],</span> <span class="s1">&#39;bhsigmafrac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;polar_kick_angle&#39;</span> <span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;qcrit_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;cekickflag&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cehestarflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;cemergeflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ecsn&#39;</span> <span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;ecsn_mlow&#39;</span> <span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ussn&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sigmadiv&#39;</span> <span class="p">:</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;qcflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;eddlimflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fprimc_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">],</span> <span class="s1">&#39;bhspinflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bhspinmag&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;rejuv_fac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;rejuvflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;htpmb&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_cr&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ST_tide&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bdecayfac&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;randomseed&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1235453</span><span class="p">,</span> <span class="s1">&#39;grflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rembar_massloss&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;kickflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;zsun&#39;</span> <span class="p">:</span> <span class="mf">0.014</span><span class="p">,</span>  <span class="s1">&#39;grflag&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;bhms_coll_flag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;don_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc_lim&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">]:</span>
    <span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span><span class="p">,</span> <span class="n">kick_info</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">single_binary</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">bpp</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">initC</span> <span class="o">=</span> <span class="n">initC</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">column</span><span class="p">:</span><span class="n">bpp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">column</span><span class="p">]})</span>
    <span class="n">bpp_mid</span><span class="p">,</span> <span class="n">bcm_mid</span><span class="p">,</span> <span class="n">initC_mid</span><span class="p">,</span> <span class="n">kick_info</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">initC</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;From beginning&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">bpp</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Started in middle at Index </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bpp_mid</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../output_info/index.html" class="btn btn-neutral float-left" title="Describing the output of COSMIC/BSE: Columns names/Values/Units" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../runpop/index.html" class="btn btn-neutral float-right" title="Generate a binary population by hand" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Katie Breivik.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>