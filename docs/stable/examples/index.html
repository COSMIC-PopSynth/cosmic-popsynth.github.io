

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using cosmic to run BSE &mdash; cosmic 3.0.0-beta+6.g810e084.dirty documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/cosmic-docs.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generate a binary population by hand" href="../runpop/index.html" />
    <link rel="prev" title="Describing the output of COSMIC/BSE: Columns names/Values/Units" href="../output_info/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> cosmic
          

          
          </a>

          
            
            
              <div class="version">
                3.0.0-beta+6.g810e084.dirty
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inifile/index.html">Configuration files for COSMIC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output_info/index.html">Describing the output of COSMIC/BSE: Columns names/Values/Units</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using cosmic to run BSE</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#single-binary">single binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiple-binaries">multiple binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#grid-of-binaries">grid of binaries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../runpop/index.html">Generate a binary population by hand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fixedpop/index.html">Generate a population the <cite>COSMIC</cite> way</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cosmic</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Using cosmic to run BSE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-cosmic-to-run-bse">
<span id="examples"></span><h1>Using cosmic to run BSE<a class="headerlink" href="#using-cosmic-to-run-bse" title="Permalink to this headline">¶</a></h1>
<p>cosmic can evolve binaries for several different use cases. Below
you’ll find examples to run a single binary system, multiple binary
systems or a grid of binaries.</p>
<div class="section" id="single-binary">
<h2>single binary<a class="headerlink" href="#single-binary" title="Permalink to this headline">¶</a></h2>
<p>Below is the process to initialize and evolve a binary that
could have formed a GW150914-like binary. First, import the modules in cosmic
that initialize and evolve the binary.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">cosmic.sample.initialbinarytable</span> <span class="kn">import</span> <span class="n">InitialBinaryTable</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">cosmic.evolve</span> <span class="kn">import</span> <span class="n">Evolve</span>
</pre></div>
</div>
<p>To initialize a single binary, populate the SingleBinary method in the
InitialBinaryTable class. Each initialized binary requires the following parameters:</p>
<ul class="simple">
<li><p>m1 : ZAMS mass of the primary star in <img class="math" src="../_images/math/ff0e573cc61eb74d35f469b1124988be4aeaaffb.png" alt="M_{\odot}"/></p></li>
<li><p>m2 : ZAMS mass of the secondary star in <img class="math" src="../_images/math/ff0e573cc61eb74d35f469b1124988be4aeaaffb.png" alt="M_{\odot}"/></p></li>
<li><p>porb : initial orbital period in days</p></li>
<li><p>ecc : initial eccentricity</p></li>
<li><p>tphysf : total evolution time of the binary in Myr</p></li>
<li><p>kstar1 : initial primary stellar type, following the BSE convention</p></li>
<li><p>kstar2 : initial secondary stellar type, following the BSE convention</p></li>
<li><p>metallicity : metallicity fraction (e.g. <img class="math" src="../_images/math/5c391f4fecdfa1ad6dfa3197c08603bd1da77ea8.png" alt="Z_{\odot}=0.02"/>)</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">single_binary</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">SingleBinary</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="mf">85.543645</span><span class="p">,</span> <span class="n">m2</span><span class="o">=</span><span class="mf">84.99784</span><span class="p">,</span> <span class="n">porb</span><span class="o">=</span><span class="mf">446.795757</span><span class="p">,</span> <span class="n">ecc</span><span class="o">=</span><span class="mf">0.448872</span><span class="p">,</span> <span class="n">tphysf</span><span class="o">=</span><span class="mf">13700.0</span><span class="p">,</span> <span class="n">kstar1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kstar2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">metallicity</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="k">print</span><span class="p">(</span><span class="n">single_binary</span><span class="p">)</span>
<span class="go">   kstar_1  kstar_2  mass1_binary  mass2_binary        porb       ecc  metallicity  binfrac   tphysf</span>
<span class="go">0      1.0      1.0     85.543645      84.99784  446.795757  0.448872        0.002      1.0  13700.0</span>
</pre></div>
</div>
<p>The flags for the various binary evolution prescriptions used in BSE also need to be set.
Each flag is saved in the BSEDict dictionary. Note that the BSEDict
only needs to be specified the first time a binary is evolved with cosmic or
if you need to change the binary evolution prescriptions.</p>
<p>If you are unfamiliar with these prescriptions, it is highly
advised to either run the defaults from the cosmic install (which are consistent
with <a class="reference external" href="http://adsabs.harvard.edu/abs/2018PhRvL.120o1101R">Rodriguez+2018</a> and <a class="reference external" href="http://adsabs.harvard.edu/abs/2018PhRvL.120s1103K">Kremer+2018</a>) or refer to <a class="reference external" href="http://adsabs.harvard.edu/abs/2002MNRAS.329..897H">Hurley+2002</a>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">BSEDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xi&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;bhflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;neta&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;windflag&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;wdflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;pts1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;pts3&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;pts2&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;epsnov&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;hewind&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ck&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;bwind&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;lambdaf&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;mxns&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;tflag&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;acc2&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;nsflag&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ceflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;eddfac&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ifflag&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bconst&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">265.0</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;pisn&#39;</span><span class="p">:</span> <span class="mf">45.0</span><span class="p">,</span> <span class="s1">&#39;natal_kick_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span><span class="o">-</span><span class="mf">100.0</span><span class="p">],</span> <span class="s1">&#39;bhsigmafrac&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;polar_kick_angle&#39;</span> <span class="p">:</span> <span class="mi">90</span><span class="p">,</span> <span class="s1">&#39;qcrit_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;cekickflag&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;cehestarflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;cemergeflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ecsn&#39;</span> <span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;ecsn_mlow&#39;</span> <span class="p">:</span> <span class="mf">1.4</span><span class="p">,</span> <span class="s1">&#39;aic&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ussn&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;sigmadiv&#39;</span> <span class="p">:</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;qcflag&#39;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;eddlimflag&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;fprimc_array&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">/</span><span class="mf">21.0</span><span class="p">]}</span>
</pre></div>
</div>
<p>Once the binary is initialized and the BSE model is set, the system is evolved with the
the Evolve class, which calls the evolv2.f subroutine in the BSE source code.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span> <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">single_binary</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">)</span>
</pre></div>
</div>
<p>For every evolved binary system, BSE generates two arrays, which are stored as pandas DataFrames in cosmic:</p>
<ul class="simple">
<li><p>bpp - contains binary parameters at important stages in the binary’s evolution, including stellar evolutionary phase changes or mass transfer episodes.</p></li>
<li><p>bcm - contains several binary parameters at user specified time steps during the binary’s evolution. The default setting in cosmic is to output the final stage of the binary at the evolution time specified by the user.</p></li>
</ul>
<p>You can see the different parameters included in each DataFrame using the columns attribute of the DataFrame:</p>
<pre class="literal-block">In [7]: print(bpp.columns)
Index(['tphys', 'mass_1', 'mass_2', 'kstar_1', 'kstar_2', 'sep', 'porb', 'ecc',
       'RROL_1', 'RROL_2', 'evol_type', 'Vsys_1', 'Vsys_2', 'SNkick',
       'SNtheta', 'aj_1', 'aj_2', 'tms_1', 'tms_2', 'massc_1', 'massc_2',
       'rad_1', 'rad_2', 'bin_num'],
      dtype='object')

In [8]: print(bcm.columns)
Index(['tphys', 'kstar_1', 'mass0_1', 'mass_1', 'lumin_1', 'rad_1', 'teff_1',
       'massc_1', 'radc_1', 'menv_1', 'renv_1', 'epoch_1', 'ospin_1',
       'deltam_1', 'RROL_1', 'kstar_2', 'mass0_2', 'mass_2', 'lumin_2',
       'rad_2', 'teff_2', 'massc_2', 'radc_2', 'menv_2', 'renv_2', 'epoch_2',
       'ospin_2', 'deltam_2', 'RROL_2', 'porb', 'sep', 'ecc', 'B_0_1', 'B_0_2',
       'SNkick_1', 'SNkick_2', 'Vsys_final', 'SNtheta_final', 'SN_1', 'SN_2',
       'bin_state', 'merger_type', 'bin_num'],
      dtype='object')</pre>
<p>The units are broadly consistent with BSE; masses, radii are in Solar units, temperatures are in log-Kelvin, luminosities are in log-Solar luminosity, orbital periods are in log-seconds, semi-major axes are in solar radii, and times are in units of Myr.</p>
<p>The evol_type column in bpp indicates the evolutionary change that occured for each line. The meaning of each number is described here, <a class="reference internal" href="../output_info/index.html#evolve-type-table"><span class="std std-ref">Evolve Type</span></a>.</p>
<p>Each of the parameters in bpp or bcm can be accessed in the usual way for DataFrames.</p>
<pre class="literal-block">In [9]: print(bpp.mass_1)
0    79.094933
0    78.936077
0    74.938003
0    62.496557
0    36.188609
0    35.959029
0    29.750532
0    26.775479
0    26.775482
0    26.775482
0    26.777384
0    26.783316
0    26.783316
0    26.783316
0    26.783316
0    26.783321
0    26.783321
0    26.783321
Name: mass_1, dtype: float64

In [10]: print(bpp[['mass_1', 'mass_2', 'kstar_1', 'kstar_2', 'sep', 'evol_type']])
     mass_1      mass_2  kstar_1  kstar_2          sep  evol_type
0  79.094933   78.667491      2.0      1.0  1473.875468        2.0
0  78.936077   78.678822      2.0      1.0  1467.357153        3.0
0  74.938003   82.622531      2.0      1.0  1403.570117       14.0
0  62.496557   94.987512      4.0      1.0  1502.124212        2.0
0  36.188609  120.165425      4.0      1.0  2110.880539        4.0
0  35.959029  120.284557      7.0      1.0  2107.818485        2.0
0  29.750532  118.328046      7.0      1.0  2224.066700       15.0
0  26.775479  118.328046     14.0      1.0  2270.409921        2.0
0  26.775482   95.640640     14.0      2.0  2690.410431        2.0
0  26.775482   95.639917     14.0      2.0  2690.426271       12.0
0  26.777384   95.437512     14.0      2.0  2694.181697        3.0
0  26.783316   45.675241     14.0      4.0   479.282047        2.0
0  26.783316   45.675241     14.0      4.0   479.282047        7.0
0  26.783316   45.424485     14.0      7.0   412.961798        8.0
0  26.783316   45.424485     14.0      7.0   412.961798        4.0
0  26.783321   36.278126     14.0      7.0   472.868733       16.0
0  26.783321   32.650313     14.0     14.0   503.608880        2.0
0  26.783321   32.650313     14.0     14.0   503.312138       10.0</pre>
</div>
<div class="section" id="multiple-binaries">
<h2>multiple binaries<a class="headerlink" href="#multiple-binaries" title="Permalink to this headline">¶</a></h2>
<p>Multiple systems can also be initialized and evolved; below is an example for systems
that could form GW150914 and GW170817 - like binaries.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">binary_set</span> <span class="o">=</span> <span class="n">InitialBinaryTable</span><span class="o">.</span><span class="n">MultipleBinary</span><span class="p">(</span><span class="n">m1</span><span class="o">=</span><span class="p">[</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">11.8</span><span class="p">],</span> <span class="n">m2</span><span class="o">=</span><span class="p">[</span><span class="mf">85.0</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">],</span> <span class="n">porb</span><span class="o">=</span><span class="p">[</span><span class="mf">10000.0</span><span class="p">,</span><span class="mf">2211.0</span><span class="p">],</span> <span class="n">ecc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.55</span><span class="p">],</span> <span class="n">tphysf</span><span class="o">=</span><span class="p">[</span><span class="mf">13700.0</span><span class="p">,</span><span class="mf">13700.0</span><span class="p">],</span> <span class="n">kstar1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">kstar2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">metallicity</span><span class="o">=</span><span class="p">[</span><span class="mf">0.005</span><span class="p">,</span><span class="mf">0.02</span><span class="p">])</span>

<span class="gp">In [12]: </span><span class="k">print</span><span class="p">(</span><span class="n">binary_set</span><span class="p">)</span>
<span class="go">   kstar_1  kstar_2  mass1_binary  mass2_binary     porb   ecc  metallicity  binfrac   tphysf</span>
<span class="go">0      1.0      1.0         100.0          85.0  10000.0  0.65        0.005      1.0  13700.0</span>
<span class="go">1      1.0      1.0          11.8          11.1   2211.0  0.55        0.020      1.0  13700.0</span>

<span class="gp">In [13]: </span><span class="n">bpp</span><span class="p">,</span> <span class="n">bcm</span><span class="p">,</span> <span class="n">initC</span>  <span class="o">=</span> <span class="n">Evolve</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">initialbinarytable</span><span class="o">=</span><span class="n">binary_set</span><span class="p">,</span> <span class="n">BSEDict</span><span class="o">=</span><span class="n">BSEDict</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that the BSEDict did not be reinitialized since the BSE model did not change.</p>
<p>As before, bpp, bcm, and initC are returned as pandas DataFrames which assign an index to each binary system we evolve. We can access each binary as follows</p>
<pre class="literal-block">In [14]: print(bpp.loc[0])
          tphys     mass_1     mass_2  kstar_1  kstar_2  ...    massc_1    massc_2        rad_1        rad_2  bin_num
0      3.537393  79.856408  74.601383      2.0      1.0  ...  35.614667   0.000000    50.062601    50.719287        0
0      3.540254  79.467829  74.600037      4.0      1.0  ...  36.326881   0.000000  1654.495522    50.975155        0
0      3.690710  56.899437  77.324114      4.0      2.0  ...  37.941472  34.097933  1958.021021    47.960822        0
0      3.693646  56.465653  77.033054      4.0      4.0  ...  37.972974  34.779822  1964.092842  1613.156443        0
0      3.816675  39.277256  63.265858      7.0      4.0  ...   0.000000  36.082256     2.215200  1809.318642        0
0      3.895830  34.701463  51.392680      7.0      4.0  ...   0.000000  36.920209     1.998783  1975.823119        0
0      3.895830  31.231317  51.392680     14.0      4.0  ...  31.231317  36.920213     0.000132  1975.823873        0
0      3.895830  31.231317  51.392680     14.0      4.0  ...  31.231317  36.920213     0.000132  1975.823873        0
0      3.985013  32.152215  38.015185     14.0      4.0  ...  32.152215  37.864338     0.000136    19.480787        0
0      3.996105  32.152216  37.978304     14.0      7.0  ...  32.152216   0.000000     0.000136     2.170012        0
0      4.057229  32.152216  34.009760     14.0      7.0  ...  32.152216   0.000000     0.000136     1.974595        0
0      4.057229  32.152216  30.608784     14.0     14.0  ...  32.152216  30.608784     0.000136     0.000130        0
0  13700.000000  32.152216  30.608784     14.0     14.0  ...  32.152216  30.608784     0.000136     0.000130        0

[13 rows x 24 columns]

In [15]: print(bcm.loc[0])
         tphys  kstar_1    mass0_1     mass_1       lumin_1  ...  SN_1  SN_2  bin_state  merger_type  bin_num
0      0.346679      1.0  99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        0
0  13700.000000     14.0  34.701463  32.152216  1.000000e-10  ...   1.0   1.0          0         -001        0

[2 rows x 43 columns]

In [16]: print(initC.loc[0])
kstar_1             1.000000
kstar_2             1.000000
mass1_binary      100.000000
mass2_binary       85.000000
porb            10000.000000
                    ...     
fprimc_11           0.095238
fprimc_12           0.095238
fprimc_13           0.095238
fprimc_14           0.095238
fprimc_15           0.095238
Name: 0, Length: 88, dtype: float64

In [17]: print(bpp.loc[1])
         tphys     mass_1     mass_2  kstar_1  kstar_2  ...   massc_1   massc_2       rad_1       rad_2  bin_num
1     18.364415  11.520052  10.909115      2.0      1.0  ...  2.606170  0.000000   10.377378    9.154203        1
1     18.409054  11.515971  10.907684      3.0      1.0  ...  2.657025  0.000000  253.588958    9.201944        1
1     18.413279  11.514165  10.907761      4.0      1.0  ...  2.657136  0.000000  489.343727    9.206627        1
1     20.381291  10.909588  10.896085      4.0      2.0  ...  3.439131  2.417346  147.470050    9.978069        1
1     20.432119  10.887458  10.894033      4.0      3.0  ...  3.459328  2.465073  205.839856  229.140010        1
1     20.437847  10.884775  10.892412      4.0      4.0  ...  3.461604  2.465212  214.531781  450.055879        1
1     20.534215  10.828794  10.837118      5.0      4.0  ...  3.499896  2.497700  487.630678  401.151523        1
1     20.541357  10.821833  10.834715      5.0      4.0  ...  3.499896  2.500107  507.294619  398.158176        1
1     20.541357  10.821833  10.834715      5.0      4.0  ...  3.499896  2.500107  507.294619  398.158176        1
1     20.541357   3.499896   2.500107      8.0      7.0  ...  1.950729  0.000000  507.294619  398.158176        1
1     20.541357   3.499896   2.500107      8.0      7.0  ...  1.950729  0.000000    0.518342    0.389854        1
1     20.667965   3.397301   2.499276      8.0      7.0  ...  2.354506  0.000000    9.360846    0.394765        1
1     20.668140   3.397007   2.499314      8.0      7.0  ...  2.355254  0.000000    9.458086    0.394774        1
1     20.668140   1.277515   2.499314     13.0      7.0  ...  2.355254  0.000000    9.458086    0.394774        1
1     23.737838   1.277515   2.348143     13.0      8.0  ...  1.277515  1.140529    0.000014    0.373212        1
1     24.017469   1.277515   2.297315     13.0      8.0  ...  1.277515  1.462633    0.000014   17.908485        1
1     24.017469   1.277515   1.277515     13.0     13.0  ...  1.277515  1.277515    0.000014    0.000014        1
1  13700.000000   1.277515   1.277515     13.0     13.0  ...  1.277515  1.277515    0.000014    0.000014        1

[18 rows x 24 columns]</pre>
</div>
<div class="section" id="grid-of-binaries">
<h2>grid of binaries<a class="headerlink" href="#grid-of-binaries" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is helpful to run a grid of initial binaries to explore how
changing a single paramter affects the evolved binary. Here we evolve
the same system that produces a GW150914-like binary, but run over several initial orbital
periods spaced evenly in log space.</p>
<pre class="literal-block">In [18]: n_grid = 10

In [19]: binary_grid = InitialBinaryTable.MultipleBinary(m1=np.ones(n_grid)*100.0, m2=np.ones(n_grid)*85.0, porb=np.logspace(3,5,n_grid), ecc=np.ones(n_grid)*0.65, tphysf=np.ones(n_grid)*13700.0, kstar1=np.ones(n_grid), kstar2=np.ones(n_grid), metallicity=np.ones(n_grid)*0.005)

In [20]: print(binary_grid)
   kstar_1  kstar_2  mass1_binary  mass2_binary           porb   ecc  metallicity  binfrac   tphysf
0      1.0      1.0         100.0          85.0    1000.000000  0.65        0.005      1.0  13700.0
1      1.0      1.0         100.0          85.0    1668.100537  0.65        0.005      1.0  13700.0
2      1.0      1.0         100.0          85.0    2782.559402  0.65        0.005      1.0  13700.0
3      1.0      1.0         100.0          85.0    4641.588834  0.65        0.005      1.0  13700.0
4      1.0      1.0         100.0          85.0    7742.636827  0.65        0.005      1.0  13700.0
5      1.0      1.0         100.0          85.0   12915.496650  0.65        0.005      1.0  13700.0
6      1.0      1.0         100.0          85.0   21544.346900  0.65        0.005      1.0  13700.0
7      1.0      1.0         100.0          85.0   35938.136638  0.65        0.005      1.0  13700.0
8      1.0      1.0         100.0          85.0   59948.425032  0.65        0.005      1.0  13700.0
9      1.0      1.0         100.0          85.0  100000.000000  0.65        0.005      1.0  13700.0

In [21]: bpp, bcm, initC  = Evolve.evolve(initialbinarytable=binary_grid, BSEDict=BSEDict)

In [22]: print(bpp)
           tphys      mass_1     mass_2  kstar_1  kstar_2  ...    massc_1    massc_2        rad_1      rad_2  bin_num
0       3.537393   79.856416  74.601412      2.0      1.0  ...  35.614672   0.000000    50.062608  50.719313        0
0       3.539811   79.534315  74.618369      2.0      1.0  ...  36.216558   0.000000   962.019751  50.951009        0
0       3.539811   79.534315  74.618369      2.0      1.0  ...  36.216558   0.000000   962.019751  50.951009        0
0       3.539811  122.876845  74.618369      2.0     15.0  ...  64.710987   0.000000   962.019751  50.951009        0
0       3.540142  122.827267   0.000000      4.0     15.0  ...  64.908119   0.000000  2292.874181  50.951009        0
..           ...         ...        ...      ...      ...  ...        ...        ...          ...        ...      ...
9       3.951480   30.357821  35.777881     14.0      4.0  ...  30.357821  35.735648     0.000129   2.287981        9
9       3.955292   30.357821  35.774606     14.0      7.0  ...  30.357821   0.000000     0.000129   2.104858        9
9       4.058203   30.357821  30.387590     14.0      7.0  ...  30.357821   0.000000     0.000129   1.844541        9
9       4.058203   30.357821  27.348831     14.0     14.0  ...  30.357821  27.348831     0.000129   0.000116        9
9   13700.000000   30.357821  27.348831     14.0     14.0  ...  30.357821  27.348831     0.000129   0.000116        9

[134 rows x 24 columns]

In [23]: print(bcm)
         tphys  kstar_1     mass0_1     mass_1       lumin_1  ...  SN_1  SN_2  bin_state  merger_type  bin_num
0      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        0
0  13700.000000     15.0  122.876845   0.000000  3.971523e+07  ...   7.0   0.0          1         0201        0
1      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        1
1  13700.000000     14.0  112.647935  40.500000  1.000000e-10  ...   6.0   0.0          1         0201        1
2      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        2
2  13700.000000     15.0   24.562899   0.000000  1.000000e-10  ...   1.0   1.0          1         1414        2
3      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        3
3  13700.000000     14.0   32.025861  29.857963  1.000000e-10  ...   1.0   1.0          0         -001        3
4      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        4
4  13700.000000     14.0   35.093921  33.225253  1.000000e-10  ...   1.0   1.0          0         -001        4
5      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        5
5  13700.000000     14.0   35.352695  32.318330  1.000000e-10  ...   1.0   1.0          0         -001        5
6      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        6
6  13700.000000     14.0   34.195635  30.909654  1.000000e-10  ...   1.0   1.0          0         -001        6
7      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        7
7  13700.000000     14.0   33.911260  30.578865  1.000000e-10  ...   1.0   1.0          0         -001        7
8      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        8
8  13700.000000     14.0   33.784712  30.434553  1.000000e-10  ...   1.0   1.0          0         -001        8
9      0.346679      1.0   99.000000  99.000000  1.276936e+06  ...   0.0   0.0          0         -001        9
9  13700.000000     14.0   33.715573  30.357821  1.000000e-10  ...   1.0   1.0          0         -001        9

[20 rows x 43 columns]</pre>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../runpop/index.html" class="btn btn-neutral float-right" title="Generate a binary population by hand" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../output_info/index.html" class="btn btn-neutral float-left" title="Describing the output of COSMIC/BSE: Columns names/Values/Units" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Katie Breivik

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>